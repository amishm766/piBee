<ng-container *ngIf="isReceiverNull">
  <div class="container-md" *ngIf="loggedInUser$ | async">
    <h4>Use search box to filter Users to Chat or see their Profile</h4>
    <div *ngIf="allUsersProfile" class="box box-primary">
      <div class="box-body">
        <table class="table table-sm table-dark table-hover">
          <tbody>
            <tr *ngFor="let userProfile of matchingUsersArray$ | async">
              <td>
                <img
                  height="30px"
                  width="30px"
                  class="rounded-circle img-circle"
                  [src]="userProfile?.image"
                />
              </td>
              <td>
                <a>{{ userProfile.address?.user.username }}</a>
              </td>

              <td>
                <span style="display: inline-block"
                  >{{ "Profile "
                  }}<i
                    class="fa fa-external-link"
                    [routerLink]="[
                      '/view-profile',
                      userProfile.address?.user.id
                    ]"
                  ></i>
                </span>
              </td>
              <td>
                <span style="display: inline-block"
                  >{{ "Chat "
                  }}<i
                    class="fa fa-comments-o"
                    (click)="setIsReceiverNull(userProfile.address?.user)"
                  ></i>
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div *ngIf="!allUsersProfile">
      <p>All profiles not loaded yet</p>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="!isReceiverNull">
  <form #chatForm="ngForm" *ngIf="message.receiver">
    <div class="form-group mt-4">
      <div class="form-group chat-container">
        <p
          id="textMessage"
          *ngFor="let messageObj of display.messageArray"
          [ngClass]="messageObj.alignment"
        >
          {{ messageObj.message.sender }} : {{ messageObj.message.content }}
        </p>
      </div>

      <div class="form-group right">
        <textarea
          rows="1"
          name="inputContent"
          [(ngModel)]="message.content"
          autofocus
          required
        ></textarea>
      </div>

      <div class="form-group right">
        <button
          (click)="createMessage()"
          class="btn btn-primary"
          type="submit"
          [disabled]="!chatForm.form.valid"
        >
          Send
        </button>
      </div>
    </div>
  </form>
</ng-container>
